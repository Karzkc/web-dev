var G=(a,e)=>(e=Symbol[a])?e:Symbol.for("Symbol."+a),M=a=>{throw TypeError(a)};var R=(a,e,i)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&M("Object expected");var t,d;i&&(t=e[G("asyncDispose")]),t===void 0&&(t=e[G("dispose")],i&&(d=t)),typeof t!="function"&&M("Object not disposable"),d&&(t=function(){try{d.call(this)}catch(h){return Promise.reject(h)}}),a.push([i,t,e])}else i&&a.push([i]);return e},y=(a,e,i)=>{var t=typeof SuppressedError=="function"?SuppressedError:function(l,m,f,g){return g=Error(f),g.name="SuppressedError",g.error=l,g.suppressed=m,g},d=l=>e=i?new t(l,e,"An error was suppressed during disposal"):(i=!0,l),h=l=>{for(;l=a.pop();)try{var m=l[1]&&l[1].call(l[2]);if(l[0])return Promise.resolve(m).then(h,f=>(d(f),h()))}catch(f){d(f)}if(i)throw e};return h()};import{compile as I,env as J,Features as b,Instrumentation as U,normalizePath as V}from"@tailwindcss/node";import{clearRequireCache as K}from"@tailwindcss/node/require-cache";import{Scanner as q}from"@tailwindcss/oxide";import{Features as P,transform as L}from"lightningcss";import W from"node:fs/promises";import S from"node:path";var v=J.DEBUG,_=/[?&](raw|url)\b/;function $(){let a=[],e=null,i=!1,t=!1,d=new x(()=>new Set),h=new q({}),l=new x(s=>{let r=e.createResolver({...e.resolve,extensions:[".css"],mainFields:["style"],conditions:["style","development|production"],tryIndex:!1,preferRelative:!0});function o(u,p){return r(u,p,!0,i)}let c=e.createResolver(e.resolve);function n(u,p){return c(u,p,!0,i)}return new B(s,()=>d,e.base,o,n)});function m(s,r,o,c){let n=!1;for(let u of h.scanFiles([{content:r,extension:o}]))n=!0,d.get(s).add(u);n&&f(c)}function f(s){for(let r of a){let o=[];for(let[c,n]of l.entries()){let u=r.moduleGraph.getModuleById(c);if(!u){s||l.delete(c);continue}l.get(c).requiresRebuild=!1,r.moduleGraph.invalidateModule(u),o.push({type:`${u.type}-update`,path:u.url,acceptedPath:u.url,timestamp:Date.now()})}o.length>0&&r.hot.send({type:"update",updates:o})}}async function g(s,r,o){let c=s.lastContent,n=await s.generate(c,r,o);if(n===!1)return;v&&o.start("Optimize CSS");let u=H(n,{minify:t});return v&&o.end("Optimize CSS"),u}async function C(s,r,o){let c={...s,getCombinedSourcemap:()=>{throw new Error("getCombinedSourcemap not implemented")}};for(let n of e.plugins){if(!n.transform||n.name.startsWith("@tailwindcss/"))continue;if(n.name.startsWith("vite:")&&n.name!=="vite:css"&&n.name!=="vite:css-post"&&n.name!=="vite:vue")continue;if(n.name==="ssr-styles")continue;let u="handler"in n.transform?n.transform.handler:n.transform;try{let p=await u.call(c,o,r);if(!p)continue;typeof p=="string"?o=p:p.code&&(o=p.code)}catch{console.error(`Error running ${n.name} on Tailwind CSS output. Skipping.`)}}return o}return[{name:"@tailwindcss/vite:scan",enforce:"pre",configureServer(s){a.push(s)},async configResolved(s){e=s,t=e.build.cssMinify!==!1,i=e.build.ssr!==!1&&e.build.ssr!==void 0},transformIndexHtml(s,{path:r}){m(r,s,"html",i)},transform(s,r,o){let c=z(r);A(r)||m(r,s,c,o?.ssr??!1)}},{name:"@tailwindcss/vite:generate:serve",apply:"serve",enforce:"pre",async transform(s,r,o){var p=[];try{if(!A(r))return;let c=R(p,new U);c.start("[@tailwindcss/vite] Generate CSS (serve)");let n=l.get(r);o?.ssr||await Promise.all(a.map(F=>F.waitForRequestsIdle(r)));let u=await n.generate(s,F=>this.addWatchFile(F),c);if(!u)return l.delete(r),s;return{code:u}}catch(w){var D=w,E=!0}finally{y(p,D,E)}}},{name:"@tailwindcss/vite:generate:build",apply:"build",enforce:"pre",async transform(s,r){var u=[];try{if(!A(r))return;let o=R(u,new U);o.start("[@tailwindcss/vite] Generate CSS (build)");let c=l.get(r);let n=await c.generate(s,E=>this.addWatchFile(E),o);if(!n)return l.delete(r),s;return{code:n}}catch(p){var w=p,D=!0}finally{y(u,w,D)}},async renderStart(){var r=[];try{let s=R(r,new U);s.start("[@tailwindcss/vite] (render start)");for(let[u,p]of l.entries()){let w=await g(p,()=>{},s);if(!w){l.delete(u);continue}await C(this,u,w)}}catch(o){var c=o,n=!0}finally{y(r,c,n)}}}]}function z(a){let[e]=a.split("?",2);return S.extname(e).slice(1)}function A(a){return a.includes("/.vite/")?void 0:(z(a)==="css"||a.includes("&lang.css"))&&!_.test(a)}function H(a,{file:e="input.css",minify:i=!1}={}){function t(d){return L({filename:e,code:d,minify:i,sourceMap:!1,drafts:{customMedia:!0},nonStandard:{deepSelectorCombinator:!0},include:P.Nesting,exclude:P.LogicalProperties|P.DirSelector|P.LightDark,targets:{safari:16<<16|1024,ios_saf:16<<16|1024,firefox:8388608,chrome:7274496},errorRecovery:!0}).code}return t(t(Buffer.from(a))).toString()}function T(a){return S.resolve(a.replace(/\?.*$/,""))}var x=class extends Map{constructor(i){super();this.factory=i}get(i){let t=super.get(i);return t===void 0&&(t=this.factory(i,this),this.set(i,t)),t}},B=class{constructor(e,i,t,d,h){this.id=e;this.getSharedCandidates=i;this.base=t;this.customCssResolver=d;this.customJsResolver=h}lastContent="";compiler;requiresRebuild=!0;scanner;candidates=new Set;dependencies=new Set;basePath=null;overwriteCandidates=null;async generate(e,i,t){this.lastContent=e;let d=T(this.id),h=S.dirname(S.resolve(d));if(!this.compiler||!this.scanner||this.requiresRebuild){K(Array.from(this.dependencies)),this.dependencies=new Set([T(d)]),v&&t.start("Setup compiler"),this.compiler=await I(e,{base:h,shouldRewriteUrls:!0,onDependency:f=>{i(f),this.dependencies.add(f)},customCssResolver:this.customCssResolver,customJsResolver:this.customJsResolver}),v&&t.end("Setup compiler");let m=(this.compiler.root==="none"?[]:this.compiler.root===null?[]:[this.compiler.root]).concat(this.compiler.globs);this.scanner=new q({sources:m})}if(!(this.compiler.features&(b.AtApply|b.JsPluginCompat|b.ThemeFunction|b.Utilities)))return!1;if(!this.overwriteCandidates||this.compiler.features&b.Utilities){v&&t.start("Scan for candidates");for(let m of this.scanner.scan())this.candidates.add(m);v&&t.end("Scan for candidates")}if(this.compiler.features&b.Utilities){for(let m of this.scanner.files)i(m);for(let m of this.scanner.globs){if(m.pattern[0]==="!")continue;let f=S.relative(this.base,m.base);f[0]!=="."&&(f="./"+f),f=V(f),i(S.posix.join(f,m.pattern));let g=this.compiler.root;if(g!=="none"&&g!==null){let C=V(S.resolve(g.base,g.pattern));if(!await W.stat(C).then(r=>r.isDirectory(),()=>!1))throw new Error(`The path given to \`source(\u2026)\` must be a directory but got \`source(${C})\` instead.`);this.basePath=C}else g===null&&(this.basePath=null)}}this.requiresRebuild=!0,v&&t.start("Build CSS");let l=this.compiler.build(this.overwriteCandidates?this.overwriteCandidates:[...this.sharedCandidates(),...this.candidates]);return v&&t.end("Build CSS"),l}sharedCandidates(){if(!this.compiler)return new Set;if(this.compiler.root==="none")return new Set;let e=/^[A-Z]:/,i=d=>this.basePath===null||d.startsWith(this.basePath)?!0:e.test(d)?!1:!d.startsWith("/"),t=new Set;for(let[d,h]of this.getSharedCandidates())if(i(d))for(let l of h)t.add(l);return t}};export{$ as default};
